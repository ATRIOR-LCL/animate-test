<!DOCTYPE html>
<html>
  <head>
    <title>智能动物识别系统</title>
    <link rel="stylesheet" href="/static/css/index.css" />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <p>Intelligent animal identification system</p>
        <div class="link">
          <a href="https://github.com/ATRIOR-LCL/animate-test" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github-icon lucide-github"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg></a>
        </div>
      </header>
      <div class="content">
        <div class="upload-form">
          <h1>Upload a picture to identify the animal 🐝</h1>
          <form
            method="POST"
            enctype="multipart/form-data"
            class="select-submit"
          >
            <label class="select-label select-item" for="select">
              <div class="select-text">Select</div>
            </label>
            <input
              id="select"
              type="file"
              name="image"
              accept="image/*"
              required
            />
            <button
              class="submit-button select-item"
              type="submit"
            >
              <p class="select-text">Identify</p>
            </button>
          </form>
        </div>
        <div class="result">
          <div class="result-text">
            <h2 class="result-h2" style="opacity: 0; transition: opacity 0.5s ease-in-out;">
              Identification results: {% if label %} {{ label }} {% endif %}
            </h2>
          </div>
          <div class="result-img">
            <span class="result-img-span">Your Identified Image</span>
            {% if image_url %}
            <img src="{{ image_url }}" alt="Uploaded Image" />
            {% endif %}
          </div>
        </div>
        <div class="desc">
          <p>
            This is an <span class="intelligent">intelligent 🤗</span> image
            recognition system for detecting animals. It is developed using the
            <span class="lightweight">lightweight 🚀</span> web development
            framework Flask and has a <span class="simple">simple 👀</span> and
            easy-to-use interface. And the system can not only detect animals,
            you can select <span class="any">any 🌟</span> picture from the
            local area, and the system can recognize it!
          </p>
        </div>
      </div>
    </div>
    <footer class="footer">
      <span>© 2025 </span><span>· Developed by</span>
      <img src="/static/images/qq.png" class="footer-avatar" alt="" />
      <span class="atrior">atrior</span> <span> with ❤️</span>
    </footer>
    <script>
      const cards = document.querySelectorAll(".select-item");
      window.addEventListener("mousemove", (e) => {
        for (let card of cards) {
          let rect = card.getBoundingClientRect();
          let x = e.clientX - rect.left - rect.width / 2;
          let y = e.clientY - rect.top - rect.height / 2;
          card.style.setProperty("--x", `${x}px`);
          card.style.setProperty("--y", `${y}px`);
        }
      });
      const input = document.querySelector("#select");

      input.addEventListener("change", (e) => {
        const fileName = e.target.files[0].name;
        const small = document.querySelector(".result-img-span");
        const img = document.querySelector(".result-img img");
        const h2 = document.querySelector(".result-h2");
        if (h2) {
          h2.style.opacity = 0;
        }
        if (img) {
          img.remove();
        }
        small.textContent = fileName;
      });

      // 页面加载完成后检查是否有识别结果
      document.addEventListener("DOMContentLoaded", () => {
        const h2 = document.querySelector(".result-h2");
        const labelText = h2.textContent.trim();
        
        // 如果有识别结果（不只是 "Identification results:"）
        if (labelText && labelText !== "Identification results:" && labelText.includes("Identification results:")) {
          // 延迟显示，让用户看到加载完成的效果
          setTimeout(() => {
            h2.style.opacity = 1;
          }, 300);
        }
      });

      // 监听表单提交，在提交时隐藏结果
      const form = document.querySelector(".select-submit");
      form.addEventListener("submit", () => {
        const h2 = document.querySelector(".result-h2");
        if (h2) {
          h2.style.opacity = 0;
        }
      });
    </script>
  </body>
</html>
